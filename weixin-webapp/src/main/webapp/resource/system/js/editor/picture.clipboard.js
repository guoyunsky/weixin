function forImage_creatediv(content){var objdiv=document.createElement("DIV");var objname="imageObject_hidDiv";objdiv.id=objname;objdiv.style.visibility='hidden';objdiv.style.float="left";objdiv.style.width=100;objdiv.style.height=80;objdiv.innerHTML=content;document.body.appendChild(objdiv);forImage_copyImages();$.successInfo("图片已成功复制到剪切板！");return true}function forImage_copyImages(){var ctrlRange=document.body.createControlRange();var a=document.getElementsByTagName("div");for(var i=0;i<a.length;i++){if(a[i].id=="imageObject_dataDiv"){ctrlRange.add(a[i])}}ctrlRange.execCommand('Copy');forImage_deletediv()}function forImage_deletediv(){var div=document.getElementById("imageObject_hidDiv");div.parentNode.removeChild(div)}function forTxt_copyLink(content){if(window.clipboardData){try{window.clipboardData.clearData();window.clipboardData.setData("Text",content);$.successInfo("链接已成功复制到剪切板！");return true}catch(e){$.errorInfo("图片复制到剪切板失败！");return false}}else if(navigator.userAgent.indexOf("Opera")!=-1){window.location=content;if(frameElement){$.alertInfo("链接地址已经复制，您在页面里面可以看到一个空白图像，您可以点击图像右键复制图像地址！")}else{$.alertInfo("链接地址已经复制到浏览器地址栏，您可以手动复制地址栏内容！")}return true}else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){$.alertInfo("<font color='red'>复制被浏览器拒绝！</font><br \/>请在浏览器地址栏输入'about:config'并回车,然后将<br \/>'signed.applets.codebase_principal_support'设置为'true'");return false}try{var clip=Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);if(!clip)return;var trans=Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);if(!trans)return;trans.addDataFlavor('text/unicode');var str=new Object();var len=new Object();var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);str.data=content;trans.setTransferData("text/unicode",str,content.length*2);var clipid=Components.interfaces.nsIClipboard;if(!clip)return false;clip.setData(trans,null,clipid.kGlobalClipboard);$.successInfo("链接已成功复制到剪切板！");return true}catch(e){$.errorInfo("链接复制到剪切板失败！请尝试在ie下使用此功能！");return false}}else{$.alertInfo("浏览器不支持复制链接到剪切板！请尝试在ie下使用此功能！");return false}}function forClipboard_getCheckedIdArray(){var elements=document.getElementsByName("ids");var ids=new Array();for(var i=0;i<elements.length;i++){if(elements[i].checked){ids.push(elements[i].value)}}return ids}function copyImage(){var ids=forClipboard_getCheckedIdArray();if(ids&&ids.length>0){var content="";var url="";var len=ids.length;for(var i=0;i<len;i++){url=document.getElementById("bigImageURL_"+ids[i]).value;content+="<div id='imageObject_dataDiv' style='width: 100%; float: left; text-align: center;'><img src='"+url+"' /></div>"}try{forImage_creatediv(content)}catch(e){$.errorInfo("图片复制到剪切板失败！请尝试在ie下使用此功能！");return false}}else{$.alertInfo("请至少选择一张图片！");return false}}function copyLink(){var ids=forClipboard_getCheckedIdArray();if(ids&&ids.length>0){var url="";var len=ids.length;var content="";for(var i=0;i<len;i++){url=document.getElementById("bigImageURL_"+ids[i]).value;content+=url+"\r\n"}forTxt_copyLink(content)}else{$.alertInfo("请至少选择一张图片！");return false}}